{%- liquid
  assign motion_delay = 50
  assign slides = section.blocks | where: 'type', 'slide'
  assign autoplay = section.settings.autoplay
  assign autoplay_speed = section.settings.autoplay_speed
-%}
<style>
  #shopify-section-{{ section.id }}{padding-top:{{section.settings.padding_top  }}px;padding-bottom:{{section.settings.padding_bottom  }}px;}
  #shopify-section-{{ section.id }} h2{ line-height:58px;font-size:46px;font-weight: 700;text-align:center}
  #shopify-section-{{ section.id }} h2 .links{ display: block;margin-top: 20px;line-height: 19px; font-size: 16px;  font-weight: normal;color: #3250C3; }
  #shopify-section-{{ section.id }} .triple-slider-section { width: 100%;  max-width: 100%;  margin: 0 auto;}
  #shopify-section-{{ section.id }} .triple-slider-container {
     position: relative;
     margin-top:{{section.settings.padding_top }}px;
     overflow:hidden
  }
  #shopify-section-{{ section.id }} .image-wrapper{
    position: relative;
    width: 900px;
    height: 450px;
    overflow: hidden;
 }
 #shopify-section-{{ section.id }} .image-wrapper .slide-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.5s ease;
  }
  #shopify-section-{{ section.id }} .slick-track {
      display: flex;
      gap: 16px;
  }
  #shopify-section-{{ section.id }} .slick-track .slick-slide{ position: relative; overflow: hidden;}
  #shopify-section-{{ section.id }} .content{position: absolute;bottom:28px;padding:0px 34px;color:#ffff;text-shadow: 0 1px 4px rgba(0, 0, 0, 0.30);}
  #shopify-section-{{ section.id }} .content h2{line-height: 28px;font-size: 20px;text-align:left;color:#fff}
  #shopify-section-{{ section.id }} .content .describe{margin-top:8px;display: -webkit-box;-webkit-line-clamp: 2;-webkit-box-orient: vertical;
  overflow: hidden; text-overflow: ellipsis;}
  #shopify-section-{{ section.id }} .content .describe p{line-height:19px;font-size: 16px; margin:0px}
  #shopify-section-{{ section.id }} .carousel-arrows button{     position: relative;
    background: rgba(118, 118, 118, 0.2);
    border: none;
    width: 48px;
    height: 48px;
    border-radius: 50%;
    padding: 0;
    font-size: 0;
    cursor: pointer;
    color: #fff;
    transition: background 0.3s;
    pointer-events: all;
    display: flex;
    align-items: center;
    justify-content: center;
    transform: none;}
   #shopify-section-{{ section.id }} .carousel-arrows button:hover {
    background: rgba(118, 118, 118, 0.5);
  }
   #shopify-section-{{ section.id }} .carousel-arrows button.prev-arrow{margin-left:0px; left: 0rem}
   #shopify-section-{{ section.id }} .carousel-arrows button.next-arrow{margin-right:0px; right: 0rem}
  /* 箭头样式 */
   #shopify-section-{{ section.id }} .slick-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    z-index: 10;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: white;
    border: none;
    cursor: pointer;
    font-size: 0;
    transition: all 0.3s ease;
  }

   #shopify-section-{{ section.id }} .slick-arrow:hover {
    background-color: #f0f0f0;
  }

   #shopify-section-{{ section.id }} .slick-prev {
    left: -15px;
  }

   #shopify-section-{{ section.id }} .slick-next {
    right: -15px;
  }

   #shopify-section-{{ section.id }} .slick-prev:before,
   #shopify-section-{{ section.id }} .slick-next:before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 12px;
    height: 12px;
    border-left: 2px solid #333;
    border-bottom: 2px solid #333;
  }

   #shopify-section-{{ section.id }} .slick-prev:before {
    transform: translate(-50%, -50%) rotate(45deg);
    margin-left: 3px;
  }

   #shopify-section-{{ section.id }} .slick-next:before {
    transform: translate(-50%, -50%) rotate(-135deg);
    margin-left: -3px;
  }

  /* 移动端样式 */
  @media (max-width: 820px) {
    #shopify-section-{{ section.id }}{padding-top:{{section.settings.padding_top | divided_by: 2  }}px;padding-bottom:{{section.settings.padding_bottom | divided_by: 2  }}px;}
    #shopify-section-{{ section.id }} h2{ line-height:34px;font-size:28px;}
    #shopify-section-{{ section.id }} h2 .links{ margin-top: 10px;}
    #shopify-section-{{ section.id }} .triple-slider-container { margin-top:{{section.settings.padding_top | divided_by: 2  }}px;}
    #shopify-section-{{ section.id }} .image-wrapper{width:300px;height:240px}
    #shopify-section-{{ section.id }} .content{ bottom: 10px; padding: 0px 12px;}
    #shopify-section-{{ section.id }} .content h2{line-height: 17px;font-size: 14px;}
    #shopify-section-{{ section.id }} .content .describe p{line-height:17px;font-size: 14px;}
    #shopify-section-{{ section.id }} .carousel-arrows{display:none}
    #shopify-section-{{ section.id }} .carousel-arrows button.prev-arrow{ left: 2rem}
    #shopify-section-{{ section.id }} .carousel-arrows button.next-arrow{ right: 2rem}
    #shopify-section-{{ section.id }} .slide-content {
      padding: 15px;
    }

     #shopify-section-{{ section.id }} .slide-heading {
      font-size: 1rem;
    }
  }
</style>

<div class="triple-slider-section" data-section-id="{{ section.id }}">
  {% if section.settings.title != blank %}
    <h2>
      <motion-element class="block" data-motion="fade-up" data-motion-delay="{{ motion_delay }}">
        <span>{{ section.settings.title }}</span>
         {% if section.settings.more_title != blank and section.settings.more_url != blank%}
            <span class="links"><a href="{{ section.settings.more_url }}" target="_blank">{{ section.settings.more_title }}</a></span>
        {% endif %}
      </motion-element>
      
    </h2>
  {% endif %}
  <div class="triple-slider-container">
    <div class="triple-carousel">
      {% for block in slides %}
        <div class="slide" {{ block.shopify_attributes }}>
          {% if block.settings.image_pc != blank %}
            <a href="{% if block.settings.links != blank %}{{ block.settings.links }}{% else %}javascript:;{% endif %}" target="{% if block.settings.links != blank %}_blank{% else %}_self{% endif %}" alt="{{ block.settings.title }}">
            <div class="image-wrapper">
              <picture>
                <!-- 移动端图片 -->
                <source
                  media="(max-width: 749px)"
                  srcset="
                    {{ block.settings.image_mobile | img_url: '800x' }} 1x,
                    {{ block.settings.image_mobile | img_url: '1600x' }} 2x
                  "
                >

                <!-- 桌面端图片 -->
                <source
                  media="(min-width: 750px)"
                  srcset="
                    {{ block.settings.image_pc | img_url: '1200x' }} 1x,
                    {{ block.settings.image_pc | img_url: '2400x' }} 2x
                  "
                >

                <!-- 默认图片 -->
                <img
                  src="{{ block.settings.image_pc | img_url: '1200x' }}"
                  alt="{{ block.settings.title | escape }}"
                  class="slide-image"
                  loading="lazy"
                  width="{{ block.settings.image_pc.width }}"
                  height="{{ block.settings.image_pc.height }}"
                >
              </picture>
            </div>
            </a>
            {% if block.settings.title != blank %}  
            <a href="{% if block.settings.links != blank %}{{ block.settings.links }}{% else %}#{% endif %}" target="_blank" alt="{{ block.settings.title }}">
            <div class="content">
              {% if block.settings.author %}
                 <div class="author">{{block.settings.author}}</div>
              {% endif  %}
              <h2 class="title">{{block.settings.title}}</h2>
              <div class="describe">{{block.settings.describe}}</div>
              {% if block.settings.date %}
                 <div class="date">{{block.settings.date}}</div>
              {% endif %}
            </div>
            </a>
            {% endif %}
          {% else %}
            {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
          {% endif %}

        </div>
      {% endfor %}
    </div>
    <div class="carousel-arrows page-width">
      <button class="prev-arrow">❮</button>
      <button class="next-arrow">❯</button>
    </div>
  </div>
</div>

<script>
    $(document).ready(function () {
      let $slider = $('[data-section-id="{{ section.id }}"] .triple-carousel');
      $slider.slick({
        slidesToShow: {% if section.blocks.size > 3 %}3{% else %}2{% endif %},
        slidesToScroll: 1,
        centerMode:  {% if section.blocks.size > 3 %}true{% else %}true{% endif %},
        centerPadding: {% if section.blocks.size > 3 %}'0'{% else %}'10%'{% endif %},
        variableWidth: {% if section.blocks.size > 3 %}true{% else %}true{% endif %},
        arrows: true,
        dots: false,
        infinite: true,
        draggable:true,
        speed: 300,
        autoplay: {{ autoplay }},
        autoplaySpeed: {{ autoplay_speed }},
        prevArrow: $('[data-section-id="{{ section.id }}"] .prev-arrow'),
        nextArrow: $('[data-section-id="{{ section.id }}"] .next-arrow'),
        responsive: [
          {
            breakpoint: 1024,
            settings: {
              slidesToShow: 2
            }
          },
          {
            breakpoint: 768,
            settings: {
              slidesToShow: 1,
              arrows: false
            }
          }
        ]
      });
    });
</script>

{% schema %}
{
  "name": "Fullscreen Slider",
  "max_blocks": 6,
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "标题",
      "default": "Title"
    },
    {
      "type": "text",
      "id": "more_title",
      "label": "更多",
    },
    {
      "type": "url",
      "id": "more_url",
      "label": "链接",
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": false
    },
    {
      "type": "range",
      "id": "autoplay_speed",
      "min": 1000,
      "max": 8000,
      "step": 500,
      "unit": "ms",
      "label": "Autoplay Speed",
      "default": 3000
    },
    {
      "type": "header",
      "content": "t:sections.all.padding.section_padding_heading"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 120,
      "step": 2,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 120,
      "step": 2,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 60
    }
  ],
  "blocks": [
    {
      "type": "slide",
      "name": "Slide",
      "settings": [
         {
          "type": "url",
          "id": "links",
          "label": "link"
        },
        {
          "type": "image_picker",
          "id": "image_pc",
          "label": "Image"
        },
        {
          "type": "image_picker",
          "id": "image_mobile",
          "label": "Mobile Image"
        },
         {
          "type": "text",
          "id": "author",
          "label": "author"
        },
        {
          "type": "text",
          "id": "title",
          "label": "title"
        },
        {
          "type": "richtext",
          "id": "describe",
          "label": "describe"
        },
        {
          "type": "text",
          "id": "date",
          "label": "date"
        },
      ]
    }
  ],
  "presets": [
    {
      "name": "Fullscreen Slider",
      "category": "自定义产品组件",
      "blocks": [
        {
          "type": "slide"
        },
        {
          "type": "slide"
        },
        {
          "type": "slide"
        }
      ]
    }
  ]
}
{% endschema %}
